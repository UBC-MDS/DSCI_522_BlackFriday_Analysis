# libraries
library(tidyverse)
male_purchases <- data %>%
filter(Gender == 'M') %>%
rep_sample_n(size = sum(data$Gender == 'M'), reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
male_one_sample <- data %>%
filter(Gender == 'M') %>%
rep_sample_n(data, size = 10000)
data <- read_csv("data/BlackFriday_tidy.csv")
getwd()
setwd("~/repos/DSCI_522_BlackFriday_Analysis")
data <- read_csv("data/BlackFriday_tidy.csv")
dim(data)
male_one_sample <- data %>%
filter(Gender == 'M') %>%
rep_sample_n(data, size = 10000)
library(infer)
male_one_sample <- data %>%
filter(Gender == 'M') %>%
rep_sample_n(data, size = 10000)
male_one_sample <- data %>%
filter(Gender == 'M') %>%
select(Purchase) %>%
rep_sample_n(size = 10000)
head(male_one_sample)
male_one_sample$replicate <- NULL
head(male_one_sample)
male_boostrapping <- male_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
head(male_boostrapping)
dim(male_boostrapping)
male_boostrapping$Gender <- 'Male'
head(male_boostrapping)
head(male_one_sample)
tail(male_one_sample)
mean(male_one_sample)
mean(male_one_sample$Purchase)
male_boostrapping$replicate <- NULL
male_boostrapping$Gender <- 'Male'
head(male_boostrapping)
dim(male_boostrapping)
female_one_sample <- data %>%
filter(Gender == 'F') %>%
select(Purchase) %>%
rep_sample_n(size = 10000)
female_one_sample$replicate <- NULL
female_one_sample$replicate <- NULL
female_boostrapping <- female_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
female_boostrapping$replicate <- NULL
female_boostrapping$Gender <- 'Female'
head(female_boostrapping)
combined_stats <- bind_rows(male_boostrapping, female_boostrapping)
library(ggplot2)
combined_stats <- bind_rows(male_boostrapping, female_boostrapping)
combined_stats %>% ggplot(aes(Gender, stat)) %>%
geom_violin()
combined_stats %>% ggplot(aes(Gender, stat)) +
geom_violin()
combined_stats %>% ggplot(aes(Gender, stat)) +
geom_violin() +
geom_point(aes(y = mean(stat)))
combined_stats %>% ggplot(aes(y = stat, group = Gender)) +
geom_violin() +
geom_point(aes(y = mean(stat)))
combined_stats %>% ggplot(aes(x = Gender)) +
geom_violin(aes(y = stat, group = Gender)) +
geom_point(aes(y = mean(stat)))
male_est <- get_ci(male_boostrapping$stat)
male_est <- get_ci(male_boostrapping)
male_est$Gender <- 'Male'
male_est$Mean <- mean(male_boostrapping$stat)
female_est <- get_ci(female_boostrapping)
female_est <- 'Female'
female_est <- mean(female_boostrapping$stat)
combined_est <- bind_rows(male_est, female_est)
male_est
female_est
female_est <- get_ci(female_boostrapping)
female_est$Gender <- 'Female'
female_est$Mean <- mean(female_boostrapping$stat)
female_est
combined_est <- bind_rows(male_est, female_est)
combined_est
colnames(combined_est) <- c("Gender", "Mean", "Lower_ci(2.5%)", "Upper_ci(97.5%)")
combined_est
combined_est <- combined_est[, c(3,4,1,2)]
combined_est
male_est <- get_ci(male_boostrapping)
male_est$Gender <- 'Male'
male_est$Mean <- mean(male_boostrapping$stat)
male_est
female_est <- get_ci(female_boostrapping)
female_est$Gender <- 'Female'
female_est$Mean <- mean(female_boostrapping$stat)
female_est
combined_est <- bind_rows(male_est, female_est)
combined_est
combined_est <- combined_est[c(3,4,1,2)]
combined_est
combined_stats %>% ggplot(aes(x = Gender)) +
geom_violin(aes(y = stat, group = Gender)) +
geom_point(data = combined_est, aes(x = Gender, y = Mean)) +
geom_errorbar(data = combined_est, aes(x = Gender, ymin = '2.5%', ymax = '97.5%'))
combined_stats %>% ggplot(aes(x = Gender)) +
geom_violin(aes(y = stat, group = Gender)) +
geom_point(data = combined_est, aes(x = Gender, y = Mean))
colnames(combined_est) <- c("Gender", "Mean", "Lower_ci", "Upper_ci")
combined_est
combined_stats %>% ggplot(aes(x = Gender)) +
geom_violin(aes(y = stat, group = Gender)) +
geom_point(data = combined_est, aes(x = Gender, y = Mean)) +
geom_errorbar(data = combined_est, aes(x = Gender, ymin = Lower_ci, ymax = Upper_ci))
# calculate delta sample
delta_sample <- mean(male_one_sample$Purchase) - mean(female_one_sample$Purchase)
# combine two samples into one
male_one_sample$Gender <- "Male"
female_one_sample$Gender <- "Female"
combined_sample <- bind_rows(male_one_sample, female_one_sample)
head(male_one_sample)
head(female_one_sample)
dim(male_one_sample)
dim(female_one_sample)
combined_sample <- bind_rows(male_one_sample, female_one_sample)
delta_sample
male_one_sample <- data %>%
filter(Gender == 'M') %>%
select(Purchase) %>%
rep_sample_n(size = 10000)
female_one_sample <- data %>%
filter(Gender == 'F') %>%
select(Purchase) %>%
rep_sample_n(size = 10000)
male_boostrapping <- male_one_sample$Purchase %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
male_boostrapping <- male_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
head(male_boostrapping)
dim(male_boostrapping)
male_one_sample <- data %>%
filter(Gender == 'M') %>%
select(Gender, Purchase) %>%
rep_sample_n(size = 10000)
head(male_one_sample)
male_boostrapping <- male_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
head(male_boostrapping)
female_one_sample <- data %>%
filter(Gender == 'F') %>%
select(Gender, Purchase) %>%
rep_sample_n(size = 10000)
# libraries
library(tidyverse)
library(infer)
library(ggplot2)
data <- read_csv("data/BlackFriday_tidy.csv")
sum(data$Gender == 'F')
male_one_sample <- data %>%
filter(Gender == 'M') %>%
select(Gender, Purchase) %>%
rep_sample_n(size = 10000)
mean(male_one_sample$Purchase)
head(male_one_sample)
male_boostrapping <- male_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
head(male_boostrapping)
head(male_one_sample)
male_one_sample$replicate <- NULL
male_boostrapping <- male_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
head(male_boostrapping)
head(male_one_sample)
female_one_sample <- data %>%
filter(Gender == 'F') %>%
select(Gender, Purchase) %>%
rep_sample_n(size = 10000)
female_one_sample$replicate <- NULL
female_boostrapping <- female_one_sample %>%
rep_sample_n(size = 10000, reps = 10000, replace = TRUE) %>%
group_by(replicate) %>%
summarize(stat = mean(Purchase))
head(female_boostrapping)
head(female_one_sample)
combined_sample <- bind_rows(male_one_sample, female_one_sample)
male_one_sample <- data %>%
filter(Gender == 'M') %>%
select(Gender, Purchase) %>%
rep_sample_n(size = 10000)
female_one_sample <- data %>%
filter(Gender == 'F') %>%
select(Gender, Purchase) %>%
rep_sample_n(size = 10000)
combined_sample <- bind_rows(male_one_sample, female_one_sample)
head(combined_sample)
combined_sample <- combined_sample["Gender", "Purchase"]
head(combined_sample)
combined_sample <- bind_rows(male_one_sample, female_one_sample)
head(combined_sample)
combined_sample <- combined_sample[c("Gender", "Purchase")]
head(combined_sample)
# calculate delta sample
delta_sample <- combined_sample %>%
group_by(Gender) %>%
summarise(mean_purchase = mean(Purchase)) %>%
diff(mean_purchase)
# calculate delta sample
purchase_est <- combined_sample %>%
group_by(Gender) %>%
summarise(mean_purchase = mean(Purchase))
delta_sample <- diff(purchase_est$mean_purchase)
delta_sample
