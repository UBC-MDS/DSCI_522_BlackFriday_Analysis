# Project: Black Friday Analysis

# Overview

This project is to analyze whether male and female make the same amount of purchase on Black Friday via a hypothesis test with a data set that contains the transactions made in a retail store on the Black Friday.

It follows the data analysis methodology shown below.  

<div align="middle">
  <img src="imgs/data-science.png"/>
  <p><em>R for Data Science by Grolemund & Wickham</em>
  <a href="https://r4ds.had.co.nz/introduction.html"> source</a>
  </p>
</div>

A specific inferential question to be addressed by this project:

> Is the amount of purchase made by male different from that made by female during Black Friday?

In this project, we defined our null hypothesis and alternative hypothesis. We wrote R scripts to clean, visualize and analyze the data set. Then we produced a final report with the decsion based on the asymptotic theory and a t-test. 

This project repository includes data, scripts, documents and results.

# Team

__Instructor__ : Tiffany Timbers

__Teaching Assistant__ : Ali Mirza

| Name  | Slack Handle | Github.com | Link |
| :------: | :---: | :----------: | :---: |
| Gilbert Lei | `@Gilbert Lei` | `@gilbertlei` | [Gilbert's link](https://github.ubc.ca/mds-2018-19/DSCI_522_proposal_junxiong)|
| Mengda Yu | `@Mengda(Albert) Yu` | `@mru4913` | [Albert's link](https://github.com/mru4913/DSCI_522_BlackFriday_Analysis) |

# Data Source

The data set we use for this project is [BlackFriday.csv](https://www.kaggle.com/mehdidag/black-friday)(5 MB), which contains over 500 000 observations about the Black Friday sales in a retail store. It involves different kinds of numerical variables, such as `purchase`, and categorical variables, such as `gender`. This dataset is originally used for people to make a better understanding of customer purchase behaviour.

##### Acknowledgements

The data set is downloaded from Kaggle.com ([download link](https://www.kaggle.com/mehdidag/black-friday)). It
originally comes from a competition hosted by `Analytics Vidhya`.

---
To read the first 5 lines from `BlackFriday.csv`, we run the following script in R. The output is shown in below image.

```
Rscript src/00_read_raw_data.R data/BlackFriday.csv 5
```

<div align="middle">
  <img src="./imgs/read_raw_data_R.png"/>
</div>

# Dependencies

- R version 3.5.1
- R libraries
  - tidyverse, *manipulate and organize dataset*
  - ggplot2, *generate graphics*
  - scales, *scale tools for graphics*
  - broom, *tidy dataset*

# Procedure

The data analysis in this project comprises of 5 steps, including clearning data, visualizing data, analyzing data, generating results and generating a final report, as shown below.


<div align="middle">
  <img src="imgs/procedure_2.png"/>
</div>


We started with cleaning data via R script `01_clean_data.R`, which takes two arguments, a file path that points to the raw data and another file path that specifies where to store the output from the script. Then we performed exploratory data analysis via R script `02_visualize_data.R`. This script loads the tidy data generated by the first script and generates a group of figures to show any patterns in the data set. In the third R script `03_analyze_data.R`, we based on asymptotic theory to calculate sampling estimates and run t-test. The results were stored in csv files in `results` folder. After that, we used `04_generate_final_result.R` to visualize these results and save these figures in `imgs` folder. In the end, we created a R Markdown file `report.Rmd` which includes all information mentioned above and is rendered into a final report in .md format in `doc` folder.

To process the data analysis, we run the following commands step by step in the `root` directory.
```
# step 1 clean data
Rscript src/01_clean_data.R data/BlackFriday.csv data/BlackFriday_tidy.csv

# step 2 run exploratory data analysis
Rscript src/02_visualize_data.R data/BlackFriday_tidy.csv imgs

# step 3 analyze data via t-test and CLT-based estimation
Rscript src/03_analyze_data.R data/BlackFriday_tidy.csv results

# step 4 make plots to visualize analysis results
Rscript src/04_generate_final_result.R results imgs

# step 5 Render Markdown file to generate project report
Rscript -e "rmarkdown::render('./doc/Report.Rmd', 'github_document')"
```

Or, we can also run all scripts via a shell script.

```
bash run_all.sh
```
